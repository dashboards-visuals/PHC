<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Medical Point – PDM Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Load Tailwind CSS -->
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
        <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
    />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
  /* Base style for tab buttons */
  .tab-button {
    border-bottom-width: 2px;
    border-bottom-color: transparent;
    transition: all 150ms ease;
  }

  /* Inactive state */
  .tab-inactive {
    color: #6b7280; /* roughly Tailwind gray-500 */
  }

  .tab-inactive:hover {
    color: #0b4f6c;
    border-bottom-color: #3b82f6; /* blue-ish hover border */
  }

  /* ACTIVE tab state */
  .tab-active {
    background-color: #0b4f6c;
    color: #ffffff;
  }
</style>

    <style>
        /* Custom styles for Chart container height */
        .chart-container {
            height: 300px;
        }
        canvas {
            width: 100% !important;
            height: 100% !important;
        }
        /* Custom font for a clean look */
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

<!-- Header Section -->
<header style="background-color:#0b4f6c;" class="text-white p-5 shadow-lg">
    <div class="max-w-7xl mx-auto flex flex-col sm:flex-row justify-between items-start sm:items-center">
        <div class="mb-2 sm:mb-0">
            <h1 class="text-2xl font-bold">Medical Point PDM Dashboard</h1>
            <p class="text-sm opacity-90 mt-1">Comparison between 1st & 2nd data collection periods (N = 389 respondents)</p>
        </div>
    </div>
</header>

<div class="max-w-7xl mx-auto p-4 sm:p-6">

    <!-- TOP SUMMARY CARDS -->
    <section class="mb-8">
        <h2 class="text-lg font-semibold text-[#0b4f6c] mb-4 border-b pb-2"></h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4">
            
            <div class="bg-white rounded-xl shadow-md p-4 transition duration-300 hover:shadow-lg border-l-4 border-blue-500">
                <h3 class="text-sm font-medium text-gray-500">Total Respondents</h3>
                <div class="text-2xl font-extrabold text-gray-900 mt-1">389</div>
                <div class="text-xs text-gray-600 mt-2">P1: 219 (56.3%) • P2: 170 (43.7%)</div>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-4 transition duration-300 hover:shadow-lg border-l-4 border-blue-500">
                <h3 class="text-sm font-medium text-gray-500">Individuals Served</h3>
                <div class="text-2xl font-extrabold text-gray-900 mt-1">1,336</div>
                <div class="text-xs text-gray-600 mt-2">814 in P1 • 522 in P2</div>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-4 transition duration-300 hover:shadow-lg border-l-4 border-green-500">
                <h3 class="text-sm font-medium text-gray-500">Overall PHC Sat.</h3>
                <div class="text-2xl font-extrabold text-green-600 mt-1">95.9%</div>
                <div class="text-xs text-gray-600 mt-2">Completely satisfied with services</div>
            </div>
            <div class="bg-white rounded-xl shadow-md p-4 transition duration-300 hover:shadow-lg border-l-4 border-green-500">
                <h3 class="text-sm font-medium text-gray-500">Safe & Accountable</h3>
                <div class="text-2xl font-extrabold text-green-600 mt-1">96%</div>
                <div class="text-xs text-gray-600 mt-2">Reporting safe, accessible, and accountable assistance.</div>
            </div>

            <div class="bg-white rounded-xl shadow-md p-4 transition duration-300 hover:shadow-lg border-l-4 border-yellow-500">
                <h3 class="text-sm font-medium text-gray-500">Displacement (P2)</h3>
                <div class="text-2xl font-extrabold text-yellow-700 mt-1">89.4%</div>
                <div class="text-xs text-gray-600 mt-2">Displaced (vs. 59.5% in P1)</div>
            </div>

             <div class="bg-white rounded-xl shadow-md p-4 transition duration-300 hover:shadow-lg border-l-4 border-red-500">
                <h3 class="text-sm font-medium text-gray-500">Waiting Time (&gt;1hr P2)</h3>
                <div class="text-2xl font-extrabold text-red-600 mt-1">57.6%</div>
                <div class="text-xs text-gray-600 mt-2">Waited >1 hour (Up from 7.8% in P1)</div>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-4 transition duration-300 hover:shadow-lg border-l-4 border-green-500">
                <h3 class="text-sm font-medium text-gray-500">FRM Access</h3>
                <div class="text-2xl font-extrabold text-green-600 mt-1">94.9%</div>
                <div class="text-xs text-gray-600 mt-2">Feel they can definitely share feedback</div>
            </div>
        </div>
    </section>

    <!-- TABBED CONTENT -->
    <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6">
        
        <!-- Tab Navigation -->
        <div class="flex flex-wrap border-b border-gray-200" id="tab-nav">
            <button data-tab="1" class="tab-button text-sm font-medium px-4 py-2 border-b-2 border-transparent text-gray-500 hover:text-[#0b4f6c] hover:border-blue-500 transition duration-150 active-tab">1. Sample Profile</button>
            <button data-tab="2" class="tab-button text-sm font-medium px-4 py-2 border-b-2 border-transparent text-gray-500 hover:text-[#0b4f6c] hover:border-blue-500 transition duration-150">2. Patient & Service Use</button>
            <button data-tab="4" class="tab-button text-sm font-medium px-4 py-2 border-b-2 border-transparent text-gray-500 hover:text-[#0b4f6c] hover:border-blue-500 transition duration-150">3. Quality & Meds</button>
            <button data-tab="3" class="tab-button text-sm font-medium px-4 py-2 border-b-2 border-transparent text-gray-500 hover:text-[#0b4f6c] hover:border-blue-500 transition duration-150">4. Access & Safety</button>
            <button data-tab="6" class="tab-button text-sm font-medium px-4 py-2 border-b-2 border-transparent text-gray-500 hover:text-[#0b4f6c] hover:border-blue-500 transition duration-150">5. Overall Satisfaction</button>
            <button data-tab="5" class="tab-button text-sm font-medium px-4 py-2 border-b-2 border-transparent text-gray-500 hover:text-[#0b4f6c] hover:border-blue-500 transition duration-150">6. Accountability & Info</button>
        </div>

        <!-- Tab Content -->
        <div class="mt-6">

            <!-- Tab 1: Sample Profile -->
            <div data-tab-content="1" class="tab-content charts-grid grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Respondents by Data Collection Period</h3>
                    <div class="chart-container"><canvas id="periodChart"></canvas></div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Gender Distribution (All Respondents)</h3>
                    <div class="chart-container"><canvas id="genderChart"></canvas></div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Displacement Status by Period (Key Change)</h3>
                    <div class="chart-container"><canvas id="displacementChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Period 2 captured a much higher share of displaced households (89.4% vs 59.5%).</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Age Distribution of Patients</h3>
                    <div class="chart-container"><canvas id="ageChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Adults: 50% • Children: 26% • Infants: 16% • Elderly: 8% • PwDs: 4%</p>
                </div>
            </div>

            <!-- Tab 2: Patient Characteristics & Service Utilization -->
            <div data-tab-content="2" class="tab-content hidden charts-grid grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Main Patient Groups</h3>
                    <div class="chart-container"><canvas id="conditionChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Chronic illness (34.2%) is the most common condition among respondents.</p>
                </div>
                <!-- <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Pregnant Women Cases by Period (Count)</h3>
                    <div class="chart-container"><canvas id="pregnantChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">30 cases in P2 vs. 23 in P1, suggesting growing maternal health needs.</p>
                </div> -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Change in Number of Consultations per Household</h3>
                    <div class="chart-container"><canvas id="consultationChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Shift from frequent (&gt;5) consultations to more 1–3 consultations in P2, suggesting disrupted continuity.</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Service Awareness Channels</h3>
                    <div class="chart-container"><canvas id="awarenessChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Community networks (Friends & Camp Committees) are the main information source (98.5%).</p>
                </div>
                 <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Participation in Mother & Child Corner Support or Awareness Sessions</h3>
                    <div class="chart-container"><canvas id="motherbabyChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">The high participation in Mother & Child Corner sessions is mainly driven by breastfeeding women (53.7%) and pregnant women (37.04%), with only a few cases falling under other categories or male caregivers.</p>
                </div>
            </div>

            <!-- Tab 3: Access, Waiting Time, Safety -->
            <div data-tab-content="3" class="tab-content hidden charts-grid grid grid-cols-1 md:grid-cols-2 gap-6">
                 <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Perceived Accessibility of the Medical Point</h3>
                    <div class="chart-container"><canvas id="accessChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">75.2% reported the point is 'close' or 'very close'.</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Waiting Time Change (Seen in &lt;30 min vs &gt;1 hour)</h3>
                    <div class="chart-container"><canvas id="waitingChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2 text-red-600 font-bold">CRITICAL: Long waits (&gt;1 hour) rose dramatically from 7.8% (P1) to 57.6% (P2).</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner col-span-1 md:col-span-2 max-w-xl mx-auto">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Feeling Completely Safe When Accessing Services (SDH1)</h3>
                    <div class="chart-container"><canvas id="safetyChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Safety perception declined from 80.4% (P1) to 64.1% (P2).</p>
                </div>
            </div>

            <!-- Tab 4: Medications & Quality of Care -->
            <div data-tab-content="4" class="tab-content hidden charts-grid grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Medication Availability (Overall)</h3>
                    <div class="chart-container"><canvas id="medsOverallChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Overall, medication availability is mostly partial (55.9%).</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Full Medication Availability by Period</h3>
                    <div class="chart-container"><canvas id="medsPeriodChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Good news: Full availability improved from 37.6% (P1) to 48.2% (P2).</p>
                </div>
                <!-- <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Respectful & Dignified Treatment (SDH2)</h3>
                    <div class="chart-container"><canvas id="respectChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Quality of interaction remains extremely high (96.9% definitely respected).</p>
                </div> -->
                
            </div>

            <!-- Tab 5: Accountability, Feedback & Information -->
            <div data-tab-content="5" class="tab-content hidden charts-grid grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Access to Feedback Channels (ACC1)</h3>
                    <div class="chart-container"><canvas id="frmChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Access improved to 100% in Period 2.</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Was Feedback Taken into Account? (PEM1)</h3>
                    <div class="chart-container"><canvas id="feedbackUseChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2 text-red-600 font-bold">93.8% reported "don’t know" if their feedback was acted upon, indicating a critical gap in the loop.</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Awareness of Available Services (PEM2)</h3>
                    <div class="chart-container"><canvas id="infoChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2 text-red-600 font-bold">Full awareness dropped significantly (89% → 58.8%) in Period 2.</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Referrals to Other Facilities (Overall)</h3>
                    <div class="chart-container"><canvas id="referralChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Only 6.2% overall were referred; most needs managed in-house.</p>
                </div>
            </div>

            
            <div data-tab-content="6" class="tab-content hidden charts-grid grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Tab 5: Over all satisfaction -->
             <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">Overall Satisfaction with Primary Healthcare (MEA1)</h3>
                    <div class="chart-container"><canvas id="satisfactionChart" class="mx-auto"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">95.9% are completely satisfied.</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner col-span-1 md:col-span-2">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">“Very Satisfied” with Key Aspects of Operations</h3>
                    <div class="chart-container h-[400px]"><canvas id="opsChart"></canvas></div>
                    <p class="text-xs text-gray-500 mt-2">Working hours, reception, and cleanliness all score highly in satisfaction.</p>
                </div>
            </div>

        </div> <!-- End Tab Content -->
    </div> <!-- End Card Container -->
</div> <!-- End Container -->

<script>
    // Define brand colors
    const PRIMARY_COLOR = '#0b4f6c'; // Dark Blue
    const SECONDARY_COLOR = '#4a90e2'; // Bright Blue
    const POSITIVE_COLOR = '#7ed321'; // Green
    const NEGATIVE_COLOR = '#d0021b'; // Red
    const WARNING_COLOR = '#f5a623'; // Orange/Yellow
    const NEUTRAL_COLOR = '#e6e6e6'; // Light Gray
    
    // --- Charting Logic ---

    // Helper function to create charts with consistent styling and responsiveness
    function createChart(ctxId, type, data, options) {
        const ctx = document.getElementById(ctxId);
        if (!ctx) return;

        const defaultColors = [
            PRIMARY_COLOR, SECONDARY_COLOR, POSITIVE_COLOR, WARNING_COLOR, NEGATIVE_COLOR, '#bd10e0', NEUTRAL_COLOR
        ];

        // Apply default colors if not already specified in datasets
        if (type === 'pie' || type === 'doughnut') {
            data.datasets.forEach(dataset => {
                if (!dataset.backgroundColor) {
                    dataset.backgroundColor = defaultColors.slice(0, data.labels.length);
                }
            });
        } else if (type === 'bar' && data.datasets.length === 1) {
            // Use Primary color for single bar charts
            data.datasets[0].backgroundColor = PRIMARY_COLOR;
        }

        // Apply specific colors for multi-dataset/stacked charts
        if (data.datasets.length > 1) {
            data.datasets[0].backgroundColor = defaultColors[0];
            data.datasets[1].backgroundColor = defaultColors[1];
            if (data.datasets[2]) data.datasets[2].backgroundColor = NEUTRAL_COLOR;
        }
        
        // Ensure chart is destroyed before re-creating on tab switch if needed
        if (Chart.getChart(ctxId)) {
            Chart.getChart(ctxId).destroy();
        }

        return new Chart(ctx, {
            type: type,
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' }
                },
                ...options
            }
        });
    }

    // Store chart instances globally
    const chartInstances = {};

    function initCharts(tabId) {
        // Only initialize charts relevant to the active tab
        
        if (tabId === '1') {
            // 1. Respondents by Period
            chartInstances.periodChart = createChart("periodChart", "bar", {
                labels: ["Period 1", "Period 2"],
                datasets: [{ label: "Number of Respondents", data: [219, 170], backgroundColor: [SECONDARY_COLOR, PRIMARY_COLOR] }]
            }, { scales: { y: { beginAtZero: true, suggestedMax: 250 } } });

            // 2. Gender distribution
            chartInstances.genderChart = createChart("genderChart", "doughnut", {
                labels: ["Female (67.1%)", "Male (32.9%)"],
                datasets: [{ data: [67.1, 32.9], backgroundColor: [SECONDARY_COLOR, PRIMARY_COLOR] }]
            });

            // 3. Displacement status by period (stacked bar)
            const displacedP1 = 59.5;
            const displacedP2 = 89.4;
            chartInstances.displacementChart = createChart("displacementChart", "bar", {
                labels: ["Period 1", "Period 2"],
                datasets: [
                    { label: "Displaced (%)", data: [displacedP1, displacedP2], stack: "disp", backgroundColor: WARNING_COLOR },
                    { label: "Non-displaced (%)", data: [100 - displacedP1, 100 - displacedP2], stack: "disp", backgroundColor: NEUTRAL_COLOR }
                ]
            }, { scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true, max: 100 } } });

            // 4. Age distribution of patients
            chartInstances.ageChart = createChart("ageChart", "bar", {
                labels: ["Adults", "Children", "Infants", "Elderly", "PwDs"],
                datasets: [{ label: "% of Patients", data: [50, 26, 16, 8, 4], backgroundColor: PRIMARY_COLOR }]
            }, { scales: { y: { beginAtZero: true, max: 60 } } });
        }

        if (tabId === '2') {
            // 5. Patient conditions
            chartInstances.conditionChart = createChart("conditionChart", "bar", {
                labels: ["Chronic illness", "Lactating women", "PwDs", "Pregnant women", "Other"],
                datasets: [{ label: "% of Patients", data: [34.2, 20.1, 16.2, 13.6, 18.8], backgroundColor: WARNING_COLOR }]
            }, { scales: { y: { beginAtZero: true, max: 40 } } });

            // 6. Pregnant women by period (counts)
            chartInstances.pregnantChart = createChart("pregnantChart", "bar", {
                labels: ["Period 1", "Period 2"],
                datasets: [{ label: "Pregnant Women Receiving Care (Count)", data: [23, 30], backgroundColor: PRIMARY_COLOR }]
            }, { scales: { y: { beginAtZero: true, suggestedMax: 40 } } });

            // 7. Consultations per household (Stacked for clarity on shift)
            const p1OtherConsultations = 100 - (65.3 + 19.9);
            const p2OtherConsultations = 100 - (30.8 + 54.4);
            chartInstances.consultationChart = createChart("consultationChart", "bar", {
                labels: ["Period 1", "Period 2"],
                datasets: [
                    { label: ">5 consultations (High)", data: [65.3, 30.8], stack: 'cons', backgroundColor: NEGATIVE_COLOR },
                    { label: "1–3 consultations (Low)", data: [19.9, 54.4], stack: 'cons', backgroundColor: POSITIVE_COLOR },
                    { label: "4 or Other", data: [p1OtherConsultations, p2OtherConsultations], stack: 'cons', backgroundColor: NEUTRAL_COLOR }
                ]
            }, { scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true, max: 100 } } });

            // 8. Service awareness channels
            chartInstances.awarenessChart = createChart("awarenessChart", "pie", {
                labels: ["Friends (72.5%)", "Camp committees (26%)", "Other (1.5%)"],
                datasets: [{ data: [72.5, 26, 1.5], backgroundColor: [SECONDARY_COLOR, PRIMARY_COLOR, NEUTRAL_COLOR] }]
            });

             //  Mother Baby Corner
            chartInstances.motherbabyChart = createChart("motherbabyChart", "pie", {
                labels: ["Yes (12%)", "No (88%)"],
                datasets: [{ data: [12, 88], backgroundColor: [SECONDARY_COLOR, PRIMARY_COLOR]}]
            });
        }

        if (tabId === '3') {
            // 9. Accessibility of the medical point
            const closePercent = 60.2 + 15; // Very close + Close = 75.2%
            const farPercent = 8.7;
            const neutralPercent = 100 - closePercent - farPercent;
            chartInstances.accessChart = createChart("accessChart", "bar", {
                labels: ["Close / Very Close", "Far / Very Far", "Neutral / Other"],
                datasets: [{ label: "% of Respondents", data: [closePercent, farPercent, neutralPercent], backgroundColor: [POSITIVE_COLOR, WARNING_COLOR, NEUTRAL_COLOR] }]
            }, { scales: { y: { beginAtZero: true, max: 100 } } });

            // 10. Waiting time (Stacked to show the shift)
            const p1OtherWait = 100 - (75.7 + 7.8);
            const p2OtherWait = 100 - (35.9 + 57.6);
            chartInstances.waitingChart = createChart("waitingChart", "bar", {
                labels: ["Period 1", "Period 2"],
                datasets: [
                    { label: "Seen within 10–30 min", data: [75.7, 35.9], stack: 'wait', backgroundColor: POSITIVE_COLOR },
                    { label: "Waited >1 hour", data: [7.8, 57.6], stack: 'wait', backgroundColor: NEGATIVE_COLOR },
                    { label: "Other wait time", data: [p1OtherWait, p2OtherWait], stack: 'wait', backgroundColor: WARNING_COLOR }
                ]
            }, { scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true, max: 100 } } });

            // 11. Safety perception – completely safe
            chartInstances.safetyChart = createChart("safetyChart", "bar", {
                labels: ["Period 1", "Period 2"],
                datasets: [{ label: "% Feeling Completely Safe", data: [80.4, 64.1], backgroundColor: NEGATIVE_COLOR }]
            }, { scales: { y: { beginAtZero: true, max: 100 } } });
        }

        if (tabId === '4') {
            // 12. Medication availability (overall)
            chartInstances.medsOverallChart = createChart("medsOverallChart", "doughnut", {
                labels: ["Fully available (42.3%)", "Partially available (55.9%)", "Unavailable (1.6%)"],
                datasets: [{ data: [42.3, 55.9, 1.6], backgroundColor: [POSITIVE_COLOR, SECONDARY_COLOR, NEGATIVE_COLOR] }]
            });

            // 13. Full availability by period
            chartInstances.medsPeriodChart = createChart("medsPeriodChart", "bar", {
                labels: ["Period 1", "Period 2"],
                datasets: [{ label: "% Full Availability of Meds", data: [37.6, 48.2], backgroundColor: POSITIVE_COLOR }]
            }, { scales: { y: { beginAtZero: true, max: 100 } } });

            // 14. Respectful & dignified treatment
            chartInstances.respectChart = createChart("respectChart", "doughnut", {
                labels: ["Definitely treated with respect (96.9%)", "Not treated respectfully (1.6%)", "Other (1.5%)"],
                datasets: [{ data: [96.9, 1.6, 1.5], backgroundColor: [PRIMARY_COLOR, NEGATIVE_COLOR, NEUTRAL_COLOR] }]
            });

           
        }

        if (tabId === '5') {
            // 16. Access to FRM (ACC1)
            chartInstances.frmChart = createChart("frmChart", "bar", {
                labels: ["Period 1", "Period 2"],
                datasets: [{ label: "% Definitely Can Share Feedback/Complaints", data: [90.9, 100], backgroundColor: POSITIVE_COLOR }]
            }, { scales: { y: { beginAtZero: true, max: 100 } } });

            // 17. Was feedback taken into account? (PEM1)
            chartInstances.feedbackUseChart = createChart("feedbackUseChart", "pie", {
                labels: ["Don’t know (93.8%)", "Yes (1.5%)", "No (0.5%)", "Other (4.2%)"],
                datasets: [{ data: [93.8, 1.5, 0.5, 4.2], backgroundColor: [WARNING_COLOR, POSITIVE_COLOR, NEGATIVE_COLOR, NEUTRAL_COLOR] }]
            });

            // 18. Awareness of services (PEM2)
            const p1NotAware = 100 - 89.0 - 6.9;
            const p2NotAware = 100 - 58.8 - 34.7;
            chartInstances.infoChart = createChart("infoChart", "bar", {
                labels: ["Period 1", "Period 2"],
                datasets: [
                    { label: "Fully aware (%)", data: [89.0, 58.8], stack: 'info', backgroundColor: PRIMARY_COLOR },
                    { label: "Somewhat aware (%)", data: [6.9, 34.7], stack: 'info', backgroundColor: SECONDARY_COLOR },
                    { label: "Not aware / Other (%)", data: [p1NotAware, p2NotAware], stack: 'info', backgroundColor: NEUTRAL_COLOR }
                ]
            }, { scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true, max: 100 } } });

            // 19. Referrals
            chartInstances.referralChart = createChart("referralChart", "bar", {
                labels: ["Overall", "Period 1", "Period 2"],
                datasets: [{ label: "% of Respondents Referred", data: [6.2, 7.3, 4.7], backgroundColor: PRIMARY_COLOR }]
            }, { scales: { y: { beginAtZero: true, max: 15 } } });
        }

        if (tabId === '6') {
            // 20. Facility operations – “very satisfied”
            chartInstances.opsChart = createChart("opsChart", "bar", {
                labels: [
                    "Clinic Working Hours (92.8%)",
                    "Reception & Organization (87.1%)",
                    "Clinic Cleanliness (86.1%)",
                    "Interaction with Medical Team (83.3%)",
                    "Overall Experience (81.8%)",
                    "Clinic Location (80.3%)"
                ],
                datasets: [{ label: "% Very Satisfied", data: [92.8, 87.1, 86.1, 83.3, 81.8, 80.3], backgroundColor: PRIMARY_COLOR }]
            }, {
                indexAxis: "y",
                scales: { x: { beginAtZero: true, max: 100 } }
            });

             // 15. Satisfaction with primary healthcare
            chartInstances.satisfactionChart = createChart("satisfactionChart", "doughnut", {
                labels: ["Completely satisfied (95.9%)", "Partially satisfied (2.6%)", "Not satisfied (1.5%)"],
                datasets: [{ data: [95.9, 2.6, 1.5], backgroundColor: [PRIMARY_COLOR, SECONDARY_COLOR, NEGATIVE_COLOR] }]
            });
        }
    }


    document.addEventListener('DOMContentLoaded', () => {
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        function switchTab(targetTabId) {
            // Update active button styling
            tabButtons.forEach(button => {
                if (button.getAttribute('data-tab') === targetTabId) {
                   button.classList.add('tab-active');
                    button.classList.remove('tab-inactive');
                } else {
                    button.classList.remove('tab-active');
                    button.classList.add('tab-inactive');
                }
            });

            // Update content visibility
            tabContents.forEach(content => {
                if (content.getAttribute('data-tab-content') === targetTabId) {
                    content.classList.remove('hidden');
                    // Initialize charts for the newly visible tab
                    initCharts(targetTabId);
                } else {
                    content.classList.add('hidden');
                }
            });
        }

        tabButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                switchTab(e.currentTarget.getAttribute('data-tab'));
            });
        });

        // Set up the initial state (Tab 1)
        switchTab('1');
    });

</script>

</body>
</html>